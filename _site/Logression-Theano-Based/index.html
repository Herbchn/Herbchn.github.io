<!DOCTYPE html> <html lang="pt-br"> <head> <link rel="icon" href="/images/herbblog.ico" type="image/x-ico"/> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <title> Logistic Regression--Theano Based &bull; Herb Home </title> <meta name="description" content="关于theano的一些认识 theano四个概念： 符号变量 符号变量是theano中定义表达式的基本组成，其特点是不保持实际的数值，作为占位符而存在。 声明： theano.scalar, theano.matrix, … op op 是定义在符..."> <link rel="stylesheet" href="/css/main.css"> <link rel="canonical" href="https://herbchn.github.io/Logression-Theano-Based/"> <link rel="alternate" type="application/rss+xml" title="Herb Home" href="https://herbchn.github.io/feed.xml" /> <script type="text/javascript"> var _gaq = _gaq || []; _gaq.push(['_setAccount', 'UA-85435362-1']); _gaq.push(['_trackPageview']); (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })(); </script> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: { autoNumber: "AMS" } }, tex2jax: { inlineMath: [ ['$','$'] ], displayMath: [ ['$$','$$'] ], processEscapes: true, } }); </script> <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"> </script> </head> <body class="single"> <main class="main"> <header class="header"> <div class="overlay"> <div class="container"> <h1 class="title"> <a href="/">Herb Home</a> </h1> <nav class="navbar"> <a href="#" class="menu-icon"> <span></span> <span></span> <span></span> </a> <ul class="nav"> <li><a href="https://github.com/Herbchn" target="_blank">Github</a></li> <li><a href="/about/">About</a></li> <li><a href="/author/">Author</a></li> </ul> </nav> </div> </div> </header> <article class="post container card"> <header class="post-header"> <h1 class="post-title">Logistic Regression--Theano Based</h1> <span class="post-meta"> <time class="post-date" datetime="2016-10-23">Oct 23, 2016</time> <span class="post-author">by Herb</span> </span> </header> <div class="post-content"> <h1 id="theano">关于theano的一些认识</h1> <ul> <li>theano四个概念： <ul> <li> <p>符号变量<br /> 符号变量是theano中定义表达式的基本组成，其特点是不保持实际的数值，作为占位符而存在。<br /> 声明： theano.scalar, theano.matrix, …</p> </li> <li>op<br /> op 是定义在符号变量上的一组运算。<br /> 例子： x, y 是符号变量， z = x + y 是一个op<br /> 注意： theano将符号表达式解析为graph，该图的节点包括：符号变量, op, apply.</li> <li> <p>shared 变量<br /> 共享变量是指可以在不同的function间共享的变量，其可以保存值，需要在声明时指定需要共享的变量的具体的数值。通常用于定义模型参数，以便与保存和更新。<br /> 声明：w = theano.shared(value=, name=””). value是需要共享的变量， name是为其指定的名字（可以不指定）。<br /> 取值：w.get_value()<br /> 赋值：w.set_value(new_value)<br /> 更新：theano.function([], target, updates=[(w, new_w)]) or function([], target, updates={w:new_w})</p> </li> <li>function<br /> function是符号表达式执行的入口，通过functon为符号变量赋值，并执行相应的操作。<br /> 声明：theano.function(inputs, outputs, updates, givens). inputs是一组符号变量的list，作为function的输入; outpus是需要的输出，可以是一个符号变量（or op），也可以list; updates对共享变量进行更新; givens是一个pairs(Var1, Var2)的list, tuple or dict，用第Var2来替换图中的节点Var1.<br /> 注意：可以采用 In 来为符号来为function的输入指定默认值，如： theano.function([x, theano.In(y, value=1)], x+y)</li> </ul> </li> </ul> <h1 id="logistic-regression">Logistic Regression</h1> <ul> <li>定义输入<br /> 定义输入 $x$ 和输出 $y$，其中前者是矩阵，维度0代表样本数，维度1代表样本的表示；后者是向量，对应于样本 $y$ 的正确输出。</li> <li><pre><code class="language-python"># define the input
x = T.dmatrix(name="x")
y = T.dvector(name="y")  
</code></pre></li> <li>初始化模型参数<br /> 根据输入的样本的表示的维度 $dim$ ，初始化模型参数 $w$ 和 $b$，并进行shared。 前者为向量，维度为 $dim$；后者为标量。</li> <li><pre><code class="language-python"># 如果未给定w，則随机初始化
if w == None:
self.w = shared(rng.randn(dim), name="w")
else:
self.w = shared(w, name = "w")
# 如果未给定b， 则随机初始化
if b == None:
self.b = shared(0., name = "b")
else:
self.b = shared(b, name = "b")
</code></pre></li> <li>定义LogisticRegression， Prediction， error， cost <ul> <li> <p>LogisticRegression函数定义： $g(x) = \frac {1.0} {1.0 + e^{-x}}$</p> </li> <li> <p>Prediction函数定义： $predict = \begin{cases} 1,\ g(x) &gt; 0.5 \ 0,\ g(x) &lt; 0.5 \end{cases}$</p> </li> <li> <p>error函数定义： $error = -\frac{1}{N} \sum_{i=1}^{N} y_i * \log g_i$</p> </li> <li> <p>cost是在cross entropy的基础上，为 $w$ 加上一个平方正则化项。</p> </li> </ul> </li> <li><pre><code class="language-python"># define the regression(g), prediction, error, cost
self.g = 1./(1. + T.exp(-T.dot(x,self.w) - self.b))
self.prediction = self.g &gt; 0.5
self.error = -y*T.log(self.g) - (1-y)*T.log(1-self.g)
cost = self.error.mean() + regular * (self.w ** 2).sum()
</code></pre></li> <li>计算梯度</li> <li><pre><code class="language-python"># compute gradient
gw, gb = T.grad(cost, [self.w, self.b])
</code></pre></li> <li>定义入口函数</li> <li><pre><code class="language-python"># define reg, train, test
self.predict = theano.function([x], self.prediction)
self.train = theano.function([x, y], self.error, updates = [(self.w, self.w - step * gw), (self.b, self.b - step * gb)])
self.test = theano.function([x,y], [self.prediction, 1 - T.mean(T.neq(self.prediction, y))])
</code></pre></li> </ul> <aside class="share"> <span>Share this: </span> <a href="http://twitter.com/share?text=Logistic Regression--Theano Based&amp;url=https://herbchn.github.io/Logression-Theano-Based/&amp;hashtags=web,dev,blog,soudev&amp;via=nandomoreirame" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;"> <i class="fa fa-twitter-square"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?u=https://herbchn.github.io/Logression-Theano-Based/" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;"> <i class="fa fa-facebook-square"></i> </a> </aside> <hr> <aside id="comments" class="disqus"> <h2 class="txt-center">Comments</h2> <div id="disqus_thread"></div> <script type="text/javascript"> var disqus_shortname = 'herbchn'; var disqus_identifier = '/Logression-Theano-Based'; var disqus_title = 'Logistic Regression--Theano Based'; var disqus_url = 'https://herbchn.github.io'; /*var disqus_developer = 1;*/ (function() { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); })(); </script> <noscript> Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a> </noscript> </aside> </div> </article> <footer class="footer t-center"> <div class="container"> <div class="social-icons"> <ul class="text-left"> <!-- <li><a href="" target="_blank"><i class="fa fa-facebook"></i></a></li> --> <li><a href="https://twitter.com/Herb_Kitty/" target="_blank"><i class="fa fa-twitter"></i></a></li> </ul> </div> <small>&copy; 2016 All rights reserved. Made with <a href="http://jekyllrb.com" target="_blank">Jekyll</a></small> </div> </footer> </main> </body> </html></body></html>

